<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../../img/favicon.ico">
  <title>Project Fern - TeachMe.Codes</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Project Fern";
    var mkdocs_page_input_path = "Projects/Fern/fern.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> TeachMe.Codes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../..">Home</a>
  </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../../../WhyCodes/">Why Codes?</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Getting started</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/anaconda/">Guide to starting Python</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/lib/">Guide to Python Libraries</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/env/">Setting up Python Environment</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/jupyter/">Installing Jupyter Notebook</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/cloud.md">Lunching an EC2 instance in AWS Cloud</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../GettingStarted/git/">How to Git</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Fundamentals of Programming</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../DataStructure/ds/">DataStructure</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../LoopsConditions/lnc/">Loops and Conditions</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Project Fern
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#project-fern">
      Project: Fern
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#method-1-blind-implementation">Method - 1: Blind implementation</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#method-2-manual-matrix-multiplication">Method-2 : Manual Matrix Multiplication</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#method-3-numpy">Method 3-Numpy</a>
        </li>
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Diffusion/Diffusion/">Project Diffusion</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../FunctionClass/fnc/">Functions and Class</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Ncharges/Ncharges/">Project N-charges</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../Rwalk/Rwalk/">Project Random Walk</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Numpy</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Numpy/array/array/">Array</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Numpy/grid/meshgrid/">MeshGrid</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Numpy/algebra/algebra/">Algebra</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Numpy/stat/stat/">Statistics</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Pandas</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Pandas/DataFrame/dataframe/">Dataframe</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Pandas/Indexing/Indexing/">Indexing</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Pandas/Explor/explor/">Data Exploration</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Pandas/GroupBy/groupby/">GroupBy</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Pandas/Lambda/lambda/">Lambda Transform</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Linear Models</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../LinearModels/Linear-models/">Regression</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Classification</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Classifiers/Logistic/Logistic/">Logistic</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Classifiers/Tree/Tree/">Decision Tree</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Classifiers/Ensamble/ensamble/">Ensamble</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../Classifiers/SVM/svm/">SVM</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">References</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../../../References/ref/">Reference</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">TeachMe.Codes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../..">Docs</a> &raquo;</li>
    
      
        
          <li>Fundamentals of Programming &raquo;</li>
        
      
    
    <li>Project Fern</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="project-fern">Project: Fern</h1>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">json</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">random</span>
<span style="color: #555555">%</span>matplotlib inline
sns<span style="color: #555555">.</span>set()
</pre></div>


<p>https://en.wikipedia.org/wiki/Barnsley_fern</p>
<h4 id="method-1-blind-implementation">Method - 1: Blind implementation</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">random</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">random</span>
x <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
y <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
X <span style="color: #555555">=</span> [x]
Y <span style="color: #555555">=</span> [y]
n<span style="color: #555555">=</span><span style="color: #FF6600">1</span>

isprint <span style="color: #555555">=</span> <span style="color: #336666">False</span>

<span style="color: #006699; font-weight: bold">while</span> n <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1000000</span>:

    r <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #FF6600">0</span>,<span style="color: #FF6600">100</span>)

    <span style="color: #006699; font-weight: bold">if</span> r <span style="color: #555555">&lt;</span>  <span style="color: #FF6600">1.0</span>:
        x <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>
        y <span style="color: #555555">=</span> <span style="color: #FF6600">0.16</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]

        X<span style="color: #555555">.</span>append(x) ; Y<span style="color: #555555">.</span>append(y)

    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">86.0</span>:
        x <span style="color: #555555">=</span> <span style="color: #FF6600">0.85</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.04</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
        y <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.04</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.85</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]<span style="color: #555555">+</span><span style="color: #FF6600">1.6</span>
        X<span style="color: #555555">.</span>append(x);Y<span style="color: #555555">.</span>append(y)
    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">86.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">93.0</span>:
        x <span style="color: #555555">=</span> <span style="color: #FF6600">0.2</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">-</span> <span style="color: #FF6600">0.26</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
        y <span style="color: #555555">=</span> <span style="color: #FF6600">0.23</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.22</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">1.6</span>

        X<span style="color: #555555">.</span>append(x);Y<span style="color: #555555">.</span>append(y)

    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">93.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">100.0</span>:
        x <span style="color: #555555">=</span> <span style="color: #555555">-</span><span style="color: #FF6600">0.15</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.28</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>]
        y <span style="color: #555555">=</span> <span style="color: #FF6600">0.26</span><span style="color: #555555">*</span>X[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.24</span><span style="color: #555555">*</span>Y[n<span style="color: #555555">-</span><span style="color: #FF6600">1</span>] <span style="color: #555555">+</span> <span style="color: #FF6600">0.44</span>

        X<span style="color: #555555">.</span>append(x);Y<span style="color: #555555">.</span>append(y)

    <span style="color: #006699; font-weight: bold">if</span> isprint:
        <span style="color: #006699; font-weight: bold">print</span>(<span style="color: #CC3300">&quot;step: &quot;</span>,n,<span style="color: #CC3300">&quot;random number is: &quot;</span>, r, <span style="color: #CC3300">&quot;coordinate is : &quot;</span>, x,y)

    n <span style="color: #555555">=</span> n<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #0099FF; font-style: italic">#for i in range(len(X)):</span>
<span style="color: #0099FF; font-style: italic">#    print(X[i],Y[i])</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #006699; font-weight: bold">with</span> <span style="color: #336666">open</span> (<span style="color: #CC3300">&#39;data/fern.json&#39;</span>, <span style="color: #CC3300">&#39;w&#39;</span>)<span style="color: #006699; font-weight: bold">as</span> f1:
    json<span style="color: #555555">.</span>dump([X,Y],f1)
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">10</span>,<span style="color: #FF6600">12</span>])
plt<span style="color: #555555">.</span>scatter(X,Y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;g&#39;</span>,marker <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;.&#39;</span>)
plt<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&#39;plot/charge-lattice.png&#39;</span>)  
plt<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&#39;plot/charge-lattice.pdf&#39;</span>) 
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_7_0.png" /></p>
<h4 id="method-2-manual-matrix-multiplication">Method-2 : Manual Matrix Multiplication</h4>
<p>These correspond to the following transformations:</p>
<p>$ {\displaystyle f_{1}(x,y)={\begin{bmatrix}\ 0.00&amp;\ 0.00\ \0.00&amp;\ 0.16\end{bmatrix}}{\begin{bmatrix}\ x\y\end{bmatrix}}}$</p>
<p>${\displaystyle f_{2}(x,y)={\begin{bmatrix}\ 0.85&amp;\ 0.04\ \-0.04&amp;\ 0.85\end{bmatrix}}{\begin{bmatrix}\ x\y\end{bmatrix}}+{\begin{bmatrix}\ 0.00\1.60\end{bmatrix}}}$</p>
<p>$ {\displaystyle f_{3}(x,y)={\begin{bmatrix}\ 0.20&amp;\ -0.26\ \0.23&amp;\ 0.22\end{bmatrix}}{\begin{bmatrix}\ x\y\end{bmatrix}}+{\begin{bmatrix}\ 0.00\1.60\end{bmatrix}}}$</p>
<p>${\displaystyle f_{4}(x,y)={\begin{bmatrix}\ -0.15&amp;\ 0.28\ \0.26&amp;\ 0.24\end{bmatrix}}{\begin{bmatrix}\ x\y\end{bmatrix}}+{\begin{bmatrix}\ 0.00\0.44\end{bmatrix}}}$</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>ITR <span style="color: #555555">=</span> <span style="color: #FF6600">100000</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>x <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.0</span>] <span style="color: #006699; font-weight: bold">for</span> k <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(ITR)])
A <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.0</span>],[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.16</span>]])
B <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.85</span>,<span style="color: #FF6600">0.04</span>],[<span style="color: #555555">-</span><span style="color: #FF6600">0.04</span>,<span style="color: #FF6600">0.85</span>]])
C <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.20</span>,<span style="color: #555555">-</span><span style="color: #FF6600">0.26</span>],[<span style="color: #FF6600">0.23</span>,<span style="color: #FF6600">0.22</span>]])
D <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #555555">-</span><span style="color: #FF6600">0.15</span>,<span style="color: #FF6600">0.28</span>],[<span style="color: #FF6600">0.26</span>,<span style="color: #FF6600">0.24</span>]])
AD <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.0</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">1.6</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">1.6</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.44</span>]])
</pre></div>


<hr />
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>X <span style="color: #555555">=</span>[]
Y <span style="color: #555555">=</span> []

x[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
x[<span style="color: #FF6600">0</span>,<span style="color: #FF6600">1</span>] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>

t <span style="color: #555555">=</span> <span style="color: #FF6600">0</span>

<span style="color: #006699; font-weight: bold">while</span> t <span style="color: #555555">&lt;</span> ITR:

    ct <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #FF6600">0</span>,<span style="color: #FF6600">100</span>)

    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;First condition&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">if</span> ct <span style="color: #555555">&lt;</span> <span style="color: #FF6600">1.0</span>:       
        <span style="color: #006699; font-weight: bold">for</span> p <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
            <span style="color: #006699; font-weight: bold">for</span> q <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
                x[t,p] <span style="color: #555555">=</span> x[t,p] <span style="color: #555555">+</span> A[p,q]<span style="color: #555555">*</span>x[t<span style="color: #555555">-</span><span style="color: #FF6600">1</span>,q]


        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;second condition&#39;&#39;&#39;</span>            
    <span style="color: #006699; font-weight: bold">elif</span> ct <span style="color: #555555">&gt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #000000; font-weight: bold">and</span> ct <span style="color: #555555">&lt;</span> <span style="color: #FF6600">86.0</span>:
        <span style="color: #006699; font-weight: bold">for</span> p  <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
            <span style="color: #006699; font-weight: bold">for</span> q <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
                x[t,p] <span style="color: #555555">=</span> x[t,p] <span style="color: #555555">+</span> B[p,q]<span style="color: #555555">*</span>x[t<span style="color: #555555">-</span><span style="color: #FF6600">1</span>,q]

        <span style="color: #006699; font-weight: bold">for</span>  p <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> x[t,p]  <span style="color: #555555">+</span> AD[<span style="color: #FF6600">1</span>,p]


        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;third condition&#39;&#39;&#39;</span>                 
    <span style="color: #006699; font-weight: bold">elif</span> ct <span style="color: #555555">&gt;</span> <span style="color: #FF6600">86.0</span> <span style="color: #000000; font-weight: bold">and</span> ct <span style="color: #555555">&lt;</span> <span style="color: #FF6600">93.0</span>:
        <span style="color: #006699; font-weight: bold">for</span> p  <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
            <span style="color: #006699; font-weight: bold">for</span> q  <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
                x[t,p] <span style="color: #555555">=</span> x[t,p] <span style="color: #555555">+</span> C[p,q]<span style="color: #555555">*</span>x[t<span style="color: #555555">-</span><span style="color: #FF6600">1</span>,q]


        <span style="color: #006699; font-weight: bold">for</span> p <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> x[t,p]  <span style="color: #555555">+</span> AD[<span style="color: #FF6600">2</span>,p]

        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;fourth condition &#39;&#39;&#39;</span>                 
    <span style="color: #006699; font-weight: bold">elif</span>  ct <span style="color: #555555">&gt;</span> <span style="color: #FF6600">93.0</span> <span style="color: #000000; font-weight: bold">and</span> ct <span style="color: #555555">&lt;</span> <span style="color: #FF6600">100.0</span>:
        <span style="color: #006699; font-weight: bold">for</span> p <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[<span style="color: #FF6600">1</span>,p] <span style="color: #555555">=</span> <span style="color: #FF6600">0.0</span>
            <span style="color: #006699; font-weight: bold">for</span> q  <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
                x[t,p] <span style="color: #555555">=</span> x[t,p] <span style="color: #555555">+</span> D[p,q]<span style="color: #555555">*</span>x[t<span style="color: #555555">-</span><span style="color: #FF6600">1</span>,q]


        <span style="color: #006699; font-weight: bold">for</span> p <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">2</span>):
            x[t,p] <span style="color: #555555">=</span> x[t,p]  <span style="color: #555555">+</span> AD[<span style="color: #FF6600">3</span>,p]




    X<span style="color: #555555">.</span>append(x[t,<span style="color: #FF6600">0</span>])
    Y<span style="color: #555555">.</span>append(x[t,<span style="color: #FF6600">1</span>])
    t <span style="color: #555555">=</span> t <span style="color: #555555">+</span><span style="color: #FF6600">1</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">10</span>,<span style="color: #FF6600">12</span>])
plt<span style="color: #555555">.</span>scatter(X,Y,color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;g&#39;</span>,marker <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;.&#39;</span>)
plt<span style="color: #555555">.</span>savefig(<span style="color: #CC3300">&#39;plot/fern.pdf&#39;</span>)    
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_14_0.png" /></p>
<h3 id="method-3-numpy">Method 3-Numpy</h3>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span><span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;Matrices&#39;&#39;&#39;</span>
A <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.0</span>],[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.16</span>]])
B <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.85</span>,<span style="color: #FF6600">0.04</span>],[<span style="color: #555555">-</span><span style="color: #FF6600">0.04</span>,<span style="color: #FF6600">0.85</span>]])
C <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.20</span>,<span style="color: #555555">-</span><span style="color: #FF6600">0.26</span>],[<span style="color: #FF6600">0.23</span>,<span style="color: #FF6600">0.22</span>]])
D <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #555555">-</span><span style="color: #FF6600">0.15</span>,<span style="color: #FF6600">0.28</span>],[<span style="color: #FF6600">0.26</span>,<span style="color: #FF6600">0.24</span>]])
AD <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([[<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.0</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">1.6</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">1.6</span>],
             [<span style="color: #FF6600">0.0</span>,<span style="color: #FF6600">0.44</span>]])
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>array([<span style="color: #FF6600">0</span>,<span style="color: #FF6600">0</span>])
U <span style="color: #555555">=</span> [u]
n <span style="color: #555555">=</span> <span style="color: #FF6600">1</span>

<span style="color: #006699; font-weight: bold">while</span> n <span style="color: #555555">&lt;</span> <span style="color: #FF6600">10000</span>:

    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;generate a random number&#39;&#39;&#39;</span>
    r <span style="color: #555555">=</span> random<span style="color: #555555">.</span>uniform(<span style="color: #FF6600">0</span>,<span style="color: #FF6600">100</span>)


    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;1rst condition&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">if</span> r <span style="color: #555555">&lt;</span>  <span style="color: #FF6600">1.0</span>:
        u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(A,u)
        U<span style="color: #555555">.</span>append(u)


        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;second condition&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">1.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">86.0</span>:
        u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(B,u) <span style="color: #555555">+</span> AD[<span style="color: #FF6600">1</span>]
        U<span style="color: #555555">.</span>append(u)


        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;third condition&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">86.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">93.0</span>:
        u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(C,u) <span style="color: #555555">+</span> AD[<span style="color: #FF6600">2</span>]
        U<span style="color: #555555">.</span>append(u)


        <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;fourth condition&#39;&#39;&#39;</span>
    <span style="color: #006699; font-weight: bold">elif</span> r <span style="color: #555555">&gt;</span> <span style="color: #FF6600">93.0</span> <span style="color: #000000; font-weight: bold">and</span> r <span style="color: #555555">&lt;</span> <span style="color: #FF6600">100.0</span>:
        u <span style="color: #555555">=</span> np<span style="color: #555555">.</span>dot(D,u) <span style="color: #555555">+</span> AD[<span style="color: #FF6600">3</span>]
        U<span style="color: #555555">.</span>append(u)


    <span style="color: #CC3300; font-style: italic">&#39;&#39;&#39;update n&#39;&#39;&#39;</span>    
    n <span style="color: #555555">=</span> n<span style="color: #555555">+</span><span style="color: #FF6600">1</span>
</pre></div>


<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%"><span></span>plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">10</span>,<span style="color: #FF6600">12</span>])
<span style="color: #006699; font-weight: bold">for</span> item <span style="color: #000000; font-weight: bold">in</span> U:
    plt<span style="color: #555555">.</span>scatter(item[<span style="color: #FF6600">0</span>],item[<span style="color: #FF6600">1</span>],color <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;g&#39;</span>,marker <span style="color: #555555">=</span> <span style="color: #CC3300">&#39;.&#39;</span>)
plt<span style="color: #555555">.</span>show()
</pre></div>


<p><img alt="png" src="../output_18_0.png" /></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../Diffusion/Diffusion/" class="btn btn-neutral float-right" title="Project Diffusion">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../../LoopsConditions/lnc/" class="btn btn-neutral" title="Loops and Conditions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../../LoopsConditions/lnc/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../Diffusion/Diffusion/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../../..';</script>
    <script src="../../../js/theme.js" defer></script>
      <script src="../../../search/main.js" defer></script>

</body>
</html>
